
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Store Creation Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-prism/prism.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="Actions.html" />
    
    
    <link rel="prev" href="TheConflux.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        <li class="header">Table of contents</li>
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../">
            
                <a href="../../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../Philosophies.html">
            
                <a href="../Philosophies.html">
            
                    
                    Philosophies
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../QuickStart.html">
            
                <a href="../QuickStart.html">
            
                    
                    Quick Start
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="./">
            
                <a href="./">
            
                    
                    Tutorial
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="FirstManager.html">
            
                <a href="FirstManager.html">
            
                    
                    First Manager
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="TheConflux.html">
            
                <a href="TheConflux.html">
            
                    
                    The Conflux
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.4.3" data-path="StoreCreation.html">
            
                <a href="StoreCreation.html">
            
                    
                    Store Creation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="Actions.html">
            
                <a href="Actions.html">
            
                    
                    Actions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5" data-path="Reducers.html">
            
                <a href="Reducers.html">
            
                    
                    Reducers
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.6" data-path="ActionInterception.html">
            
                <a href="ActionInterception.html">
            
                    
                    Action Interception
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.7" data-path="ConfluxInjection.html">
            
                <a href="ConfluxInjection.html">
            
                    
                    Conflux Injection
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.8" data-path="Selectors.html">
            
                <a href="Selectors.html">
            
                    
                    Selectors
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.9" data-path="TheModularManager.html">
            
                <a href="TheModularManager.html">
            
                    
                    The Modular Manager
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.10" data-path="HigherOrderReducers.html">
            
                <a href="HigherOrderReducers.html">
            
                    
                    Higher-Order Reducers
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.11" data-path="TheBigPicture.html">
            
                <a href="TheBigPicture.html">
            
                    
                    The Big Picture
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../examples/README.md">
            
                <span>
            
                    
                    Examples
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../examples/ClassicTodos.md">
            
                <span>
            
                    
                    Classic Todos
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../examples/RPG.md">
            
                <span>
            
                    
                    RPG
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../api/README.md">
            
                <span>
            
                    
                    API
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../api/Action.md">
            
                <span>
            
                    
                    Action
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../api/Actions.md">
            
                <span>
            
                    
                    Actions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="../api/Manage.md">
            
                <span>
            
                    
                    Manage
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../.." >Store Creation</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="store-creation">Store Creation</h1>
<p>Here&apos;s our file that declares a <code>gold</code> Manager and exports its Conflux:</p>
<pre class="language-"><code class="lang-javascript"><span class="token comment" spellcheck="true">// gold.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Manage<span class="token punctuation">,</span> Value<span class="token punctuation">,</span> getConflux <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;fluxuate&apos;</span>

@<span class="token function">Manage</span><span class="token punctuation">(</span><span class="token string">&apos;gold&apos;</span><span class="token punctuation">)</span>
@<span class="token function">Value</span><span class="token punctuation">(</span><span class="token number">8000</span><span class="token punctuation">)</span>
<span class="token keyword">class</span> <span class="token class-name">GoldManager</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">getConflux</span><span class="token punctuation">(</span>GoldManager<span class="token punctuation">)</span>
</code></pre>
<p>Let&apos;s use it.</p>
<h3 id="simple-store">Simple Store</h3>
<pre class="language-"><code class="lang-javascript"><span class="token comment" spellcheck="true">// store.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> createStore <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;redux&apos;</span>
<span class="token keyword">import</span> gold <span class="token keyword">from</span> <span class="token string">&apos;./gold&apos;</span>

<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">createStore</span><span class="token punctuation">(</span>gold<span class="token punctuation">)</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// 8000</span>
</code></pre>
<p>This will work because the gold Conflux is just a Redux reducer. But it doesn&apos;t really give us anything we didn&apos;t already have. To enable coolness, we&apos;ll need to create and apply the Fluxuate middleware to the store:</p>
<pre class="language-"><code class="lang-javascript"><span class="token comment" spellcheck="true">// store.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> applyMiddleware<span class="token punctuation">,</span> createStore <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;redux&apos;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> createFluxuateMiddleware <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;fluxuate&apos;</span>
<span class="token keyword">import</span> gold <span class="token keyword">from</span> <span class="token string">&apos;./gold&apos;</span>

<span class="token keyword">const</span> fluxuateMiddleware <span class="token operator">=</span> <span class="token function">createFluxuateMiddleware</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">createStore</span><span class="token punctuation">(</span>gold<span class="token punctuation">,</span> <span class="token function">applyMiddleware</span><span class="token punctuation">(</span>fluxuateMiddleware<span class="token punctuation">)</span><span class="token punctuation">)</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// 8000</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>gold<span class="token punctuation">.</span>state<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// 8000</span>
</code></pre>
<h3 id="confluxstate"><code>Conflux.state</code></h3>
<p>Ah-hah! So I lied. The Conflux isn&apos;t <strong>just</strong> a normal Redux reducer. It has a couple dynamic properties that beef it up a little.</p>
<p><code>Conflux.state</code> is a dynamic property (a getter) that retrieves the current value of the Conflux&apos;s Manager&apos;s state slice. Since a Manager knows what portion of state it controls, it can find the value of its state slice for us.</p>
<pre class="language-"><code class="lang-javascript"><span class="token comment" spellcheck="true">// This means that</span>
superNestedConflux<span class="token punctuation">.</span>state

<span class="token comment" spellcheck="true">// is a shorthand for</span>
store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>path<span class="token punctuation">.</span>to<span class="token punctuation">.</span><span class="token keyword">super</span><span class="token punctuation">.</span>nested<span class="token punctuation">.</span>value
</code></pre>
<p>All Confluxes have <code>state</code>, <code>action</code>, and <code>select</code> as dynamic properties. We&apos;ll learn about <code>action</code> and <code>select</code> later.</p>
<h3 id="k-but-the-stores-state-is-wrong">K... but the store&apos;s state is wrong</h3>
<p>Since we used the gold Conflux as the store&apos;s root reducer, the store&apos;s shape will match the value controlled by the gold Manager. In this case, it&apos;ll be a number. But we want it to be an object like:</p>
<pre class="language-"><code class="lang-javascript"><span class="token punctuation">{</span>
    gold<span class="token punctuation">:</span> <span class="token number">8000</span>
<span class="token punctuation">}</span>
</code></pre>
<p>To fix this, we could use <code>Redux.combineReducers()</code> (or roll our own version of it):</p>
<pre class="language-"><code class="lang-javascript"><span class="token comment" spellcheck="true">// store.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> applyMiddleware<span class="token punctuation">,</span> combineReducers<span class="token punctuation">,</span> createStore <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;redux&apos;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> createFluxuateMiddleware <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;fluxuate&apos;</span>
<span class="token keyword">import</span> gold <span class="token keyword">from</span> <span class="token string">&apos;./gold&apos;</span>

<span class="token keyword">const</span> rootReducer <span class="token operator">=</span> <span class="token function">combineReducers</span><span class="token punctuation">(</span><span class="token punctuation">{</span> gold <span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> fluxuateMiddleware <span class="token operator">=</span> <span class="token function">createFluxuateMiddleware</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">createStore</span><span class="token punctuation">(</span>rootReducer<span class="token punctuation">,</span> <span class="token function">applyMiddleware</span><span class="token punctuation">(</span>fluxuateMiddleware<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
<p>So that&apos;s cool, but it just so happens that Fluxuate does this work for us.</p>
<h3 id="the-root-conflux">The Root Conflux</h3>
<p>This is a special Conflux that Fluxuate creates for us. The Root Conflux does not have a Manager. Its job is to control the entire store. Basically, it is meant to be used as our store&apos;s root reducer (though, of course, we can use it anywhere we want). Fluxuate will constantly modify the Root Conflux&apos;s behavior as new Managers are declared.</p>
<p>So how do we get it?</p>
<pre class="language-"><code class="lang-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span> getConflux <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;fluxuate&apos;</span>

<span class="token keyword">const</span> rootConflux <span class="token operator">=</span> <span class="token function">getConflux</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<p>Yep, calling <code>getConflux()</code> with no arguments returns the Root Conflux. Let&apos;s plug it in:</p>
<pre class="language-"><code class="lang-javascript"><span class="token comment" spellcheck="true">// store.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> applyMiddleware<span class="token punctuation">,</span> createStore <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;redux&apos;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> createFluxuateMiddleware<span class="token punctuation">,</span> getConflux <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;fluxuate&apos;</span>
<span class="token keyword">import</span> gold <span class="token keyword">from</span> <span class="token string">&apos;./gold&apos;</span>

<span class="token keyword">const</span> rootConflux <span class="token operator">=</span> <span class="token function">getConflux</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> fluxuateMiddleware <span class="token operator">=</span> <span class="token function">createFluxuateMiddleware</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">createStore</span><span class="token punctuation">(</span>rootConflux<span class="token punctuation">,</span> <span class="token function">applyMiddleware</span><span class="token punctuation">(</span>fluxuateMiddleware<span class="token punctuation">)</span><span class="token punctuation">)</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// { gold: 8000 }</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>gold<span class="token punctuation">.</span>state<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// 8000</span>
</code></pre>
<p>Sweet.</p>
<h3 id="kill-boilerplate">Kill Boilerplate</h3>
<p>So there are still a lot of moving parts here. Middleware creation/application, Confluxes, and whatnot. While it&apos;s all necessary, we really shouldn&apos;t have to worry about it in most cases. To this end, Fluxuate provides a handy little tool called <code>handleStoreCreation()</code>.</p>
<pre class="language-"><code class="lang-javascript"><span class="token comment" spellcheck="true">// store.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> handleStoreCreation <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;fluxuate&apos;</span>
<span class="token keyword">import</span> gold <span class="token keyword">from</span> <span class="token string">&apos;./gold&apos;</span>

<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">handleStoreCreation</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// { gold: 8000 }</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>gold<span class="token punctuation">.</span>state<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// 8000</span>
</code></pre>
<h3 id="notes">Notes</h3>
<ul>
<li><p><code>Conflux.state</code> is just one of many features that are made available when we add the Fluxuate middleware to our store enhancer. As such, it is best practice to always add the Fluxuate middleware. Of course, we don&apos;t have to worry about it if we let Fluxuate handle the store creation.</p>
</li>
<li><p><code>handleStoreCreation()</code> is actually almost as flexible as <code>Redux.createStore()</code> itself. For full details, see the <a href="../api/handleStoreCreation.md">API</a>.</p>
</li>
</ul>
<h3 id="next-step">Next Step</h3>
<p>Let&apos;s add some <a href="Actions.html">Actions</a>.</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="TheConflux.html" class="navigation navigation-prev " aria-label="Previous page: The Conflux">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="Actions.html" class="navigation navigation-next " aria-label="Next page: Actions">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Store Creation","level":"1.4.3","depth":2,"next":{"title":"Actions","level":"1.4.4","depth":2,"path":"docs/tutorial/Actions.md","ref":"docs/tutorial/Actions.md","articles":[]},"previous":{"title":"The Conflux","level":"1.4.2","depth":2,"path":"docs/tutorial/TheConflux.md","ref":"docs/tutorial/TheConflux.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["prism","-highlight"],"pluginsConfig":{"prism":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"docs/styles/website.css"}},"file":{"path":"docs/tutorial/StoreCreation.md","mtime":"2017-09-20T21:26:47.928Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2017-10-03T22:00:32.344Z"},"basePath":"../..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

